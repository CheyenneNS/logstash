filter {
    mutate {
        lowercase => [ "type" ]
        add_field => { "index" => "logstash-%{type}-%{+YYYY.MM.dd}" }
    }

    # If we are given a timestamp field, use that as the timestamp
    if [timestamp] {
        date {
            match => ["timestamp", "ISO8601"]
        }
        mutate {
            remove_field => [ "timestamp"]
        }
    }

    # Drop if type isn't a "word"
    if [type] !~ /^[\w]+$/ {
        drop { }
    }
}
